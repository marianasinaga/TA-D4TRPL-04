module.exports=function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=6)}([function(e,t){e.exports=require("@ont-community/window-post-message-proxy")},function(e,t){e.exports=require("crypto-js")},function(e,t){e.exports=require("webextension-polyfill-ts")},function(e,t){e.exports=require("promise-timeout")},function(e,t){e.exports=require("base-x")},function(e,t){e.exports=require("typedarray-to-buffer")},function(e,t,n){"use strict";n.r(t),n.d(t,"TransactionType",(function(){return j})),n.d(t,"VmType",(function(){return N})),n.d(t,"client",(function(){return o})),n.d(t,"provider",(function(){return r})),n.d(t,"Tunnel",(function(){return i})),n.d(t,"Rpc",(function(){return a}));var r={};n.r(r),n.d(r,"registerContentProxy",(function(){return d})),n.d(r,"ExtensionType",(function(){return c})),n.d(r,"registerProvider",(function(){return l}));var o={};n.r(o),n.d(o,"registerClient",(function(){return w})),n.d(o,"api",(function(){return W}));var s=n(0);class i{constructor(e){if(this.source=e.source,this.destination=e.destination,this.postMessage=e.postMessage,this.messageHandler=e.messageHandler,this.logMessages=e.logMessages,void 0===e.addListener&&void 0===e.postMessage)throw new Error("Either addListener or postMessage must be present.");if(void 0!==e.addListener){if(void 0===e.messageHandler)throw new Error("MessageHandler must be specified if addListener present.");e.addListener(this.onMessage.bind(this))}}async send(e){const t={destination:this.destination,payload:e,source:this.source,type:"dAPI.js"};if(void 0===this.postMessage)throw new Error("PostMessage was not specified.");this.logMessages&&console.warn(`Tunnel: (${this.source}): Sending`,JSON.stringify(e,null,"  "));const n=await this.postMessage(t);if(void 0!==n.error)throw new Error(n.error);return n.payload}onMessage(e,t){if(e.destination===this.source&&e.source===this.destination){let n;try{if(void 0===this.messageHandler)throw new Error("MessageHandler was not specified.");this.logMessages&&console.warn(`Tunnel: (${this.source}): Receiving`,JSON.stringify(e.payload,null,"  "));const r={id:t.id,url:t.url},o=this.messageHandler(e.payload,r);n=Promise.resolve(o)}catch(e){n=Promise.reject(e)}return n.then(t=>({destination:e.source,payload:t,source:e.destination,type:"dAPI.js"})).catch(t=>({destination:e.source,error:t,source:e.destination,type:"dAPI.js"}))}}}class a{constructor(e){e.messageHandler=this.messageHandler.bind(this),this.tunnel=new i(e),this.methods=new Map}call(e,...t){const n={method:e,params:t};return this.tunnel.send(n)}register(e,t){this.methods.set(e,t)}messageHandler(e,t){const n=this.methods.get(e.method);if(void 0===n)throw new Error("Unregistered method call: "+e.method);return n.call(t,...e.params)}}let g;function d({logMessages:e=!1,logWarnings:t=!1,extension:r=c.Cyano}){const{browser:o}=n(2);new s.WindowPostMessageProxy({logMessages:e,suppressWarnings:!t,name:r===c.Cyano?"content-script":"content-script-"+r,target:"page"}).addHandler({handle:e=>o.runtime.sendMessage(e),test:e=>"dAPI.js"===e.type&&"page"===e.source})}var c;function l({provider:e,logMessages:t}){const{browser:r}=n(2);function o(e,t){if(void 0===t)throw new Error("DApi provider does not implement "+e);g.register(e,t)}g=new a({source:"background",destination:"page",logMessages:t,addListener:r.runtime.onMessage.addListener}),o("asset.getAccount",e.asset.getAccount),o("asset.getPublicKey",e.asset.getPublicKey),o("asset.send",e.asset.send),o("identity.getIdentity",e.identity.getIdentity),o("identity.getDDO",e.identity.getDDO),o("identity.addAttributes",e.identity.addAttributes),o("identity.removeAttribute",e.identity.removeAttribute),o("identity.addCredential",e.identity.addCredential),o("identity.getCredentials",e.identity.getCredentials),o("message.signMessage",e.message.signMessage),o("message.verifyMessage",e.message.verifyMessage),o("message.signMessageHash",e.message.signMessageHash),o("message.verifyMessageHash",e.message.verifyMessageHash),o("network.getAllowance",e.network.getAllowance),o("network.getBalance",e.network.getBalance),o("network.getBlock",e.network.getBlock),o("network.getBlockHeight",e.network.getBlockHeight),o("network.getMerkleProof",e.network.getMerkleProof),o("network.getNetwork",e.network.getNetwork),o("network.getNodeCount",e.network.getNodeCount),o("network.getStorage",e.network.getStorage),o("network.getTransaction",e.network.getTransaction),o("network.isConnected",e.network.isConnected),o("network.getUnboundOng",e.network.getUnboundOng),o("network.getContract",e.network.getContract),o("network.getSmartCodeEvent",e.network.getSmartCodeEvent),o("network.getBlockHeightByTxHash",e.network.getBlockHeightByTxHash),o("network.getBlockHash",e.network.getBlockHash),o("network.getBlockTxsByHeight",e.network.getBlockTxsByHeight),o("network.getGasPrice",e.network.getGasPrice),o("network.getGrantOng",e.network.getGrantOng),o("network.getMempoolTxCount",e.network.getMempoolTxCount),o("network.getMempoolTxState",e.network.getMempoolTxState),o("network.getVersion",e.network.getVersion),o("smartContract.invoke",e.smartContract.invoke),o("smartContract.invokeRead",e.smartContract.invokeRead),o("smartContract.deploy",e.smartContract.deploy),o("smartContract.invokeWasm",e.smartContract.invokeWasm),o("smartContract.invokeWasmRead",e.smartContract.invokeWasmRead),o("provider.getProvider",e.provider.getProvider),o("stateChannel.login",e.stateChannel.login),o("stateChannel.sign",e.stateChannel.sign)}let u,k;function w({logMessages:e=!1,logWarnings:t=!1,extension:n=c.Cyano}){u=new s.WindowPostMessageProxy({name:"page",target:n===c.Cyano?"content-script":"content-script-"+n,logMessages:e,suppressWarnings:!t}),k=new a({source:"page",destination:"background",logMessages:!1,postMessage:e=>u.postMessage(window,e)})}async function y(e,...t){return k.call(e,...t)}!function(e){e.Cyano="cyano",e.Onto="onto"}(c||(c={}));const p={getAccount:()=>y("asset.getAccount"),getPublicKey:()=>y("asset.getPublicKey"),send:e=>y("asset.send",e)},m={getIdentity:()=>y("identity.getIdentity"),getDDO:e=>y("identity.getDDO",e),addAttributes:e=>y("identity.addAttributes",e),removeAttribute:e=>y("identity.removeAttribute",e),addCredential:e=>y("identity.addCredential",e),getCredentials:()=>y("identity.getCredentials")},f={signMessageHash:e=>y("message.signMessageHash",e),verifyMessageHash:e=>y("message.verifyMessageHash",e),signMessage:e=>y("message.signMessage",e),verifyMessage:e=>y("message.verifyMessage",e)},h={getNodeCount:()=>y("network.getNodeCount"),getBlockHeight:()=>y("network.getBlockHeight"),getMerkleProof:e=>y("network.getMerkleProof",e),getStorage:e=>y("network.getStorage",e),getAllowance:e=>y("network.getAllowance",e),getBlock:e=>y("network.getBlock",e),getTransaction:e=>y("network.getTransaction",e),getNetwork:()=>y("network.getNetwork"),getBalance:e=>y("network.getBalance",e),isConnected:()=>y("network.isConnected"),getUnboundOng:e=>y("network.getUnboundOng",e),getContract:e=>y("network.getContract",e),getSmartCodeEvent:e=>y("network.getSmartCodeEvent",e),getBlockHeightByTxHash:e=>y("network.getBlockHeightByTxHash",e),getBlockHash:e=>y("network.getBlockHash",e),getBlockTxsByHeight:e=>y("network.getBlockTxsByHeight",e),getGasPrice:()=>y("network.getGasPrice"),getGrantOng:e=>y("network.getGrantOng",e),getMempoolTxCount:()=>y("network.getMempoolTxCount"),getMempoolTxState:e=>y("network.getMempoolTxState",e),getVersion:()=>y("network.getVersion")};var v=n(3);const M={getProvider:()=>Object(v.timeout)(y("provider.getProvider"),1e3).catch(()=>Promise.reject("NO_PROVIDER"))},C={invoke:e=>y("smartContract.invoke",e),invokeRead:e=>y("smartContract.invokeRead",e),deploy:e=>y("smartContract.deploy",e),invokeWasm:e=>y("smartContract.invokeWasm",e),invokeWasmRead:e=>y("smartContract.invokeWasmRead",e)},b={login:()=>y("stateChannel.login"),sign:e=>y("stateChannel.sign",e)};var H=n(4),x=n(1);const P=n(5),T=H("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz");function B(e){const t=E(T.decode(e)).substr(2,40);if(e!==A(t))throw new Error("[addressToU160] decode encoded verify failed");return t}function A(e){const t="17"+e,n=S(t),r=S(n).slice(0,8),o=P(new Uint8Array(O(t+r)));return T.encode(o)}function S(e){const t=x.enc.Hex.parse(e);return x.SHA256(t).toString()}function O(e){const t=[];for(;e.length>=2;)t.push(parseInt(e.substring(0,2),16)),e=e.substring(2,e.length);return t}function E(e){let t="";const n=new Uint8Array(e);for(let e=0;e<n.byteLength;e++){let r=n[e].toString(16);r=0===r.length?"00":1===r.length?"0"+r:r,t+=r}return t}const W={asset:p,identity:m,message:f,network:h,provider:M,smartContract:C,stateChannel:b,utils:{strToHex:e=>E(function(e){const t=new ArrayBuffer(e.length),n=new Uint8Array(t);for(let t=0,r=e.length;t<r;t++)n[t]=e.charCodeAt(t);return t}(e)),hexToStr(e){return t=O(e),String.fromCharCode.apply(null,Array.from(new Uint8Array(t)));var t},addressToHex:e=>B(e),hexToAddress:e=>A(e),isAddress(e){try{return B(e),!0}catch(e){return!1}}}};var j,N;!function(e){e[e.BookKeeper=2]="BookKeeper",e[e.Claim=3]="Claim",e[e.Deploy=208]="Deploy",e[e.Invoke=209]="Invoke",e[e.Enrollment=4]="Enrollment",e[e.Vote=5]="Vote"}(j||(j={})),function(e){e[e.NEOVM_TYPE=1]="NEOVM_TYPE",e[e.WASMVM_TYPE=3]="WASMVM_TYPE"}(N||(N={}))}]);
//# sourceMappingURL=index.js.map